---
layout: post
title: "SS week5"
date: 2017-03-27 14:19:35 +0800
comments: true
categories: Service_Security
---

# Symmetric Cryptography(Con't)

<!--more-->

## Stream Ciphers

1. A5/1 Cipher (GSM)
  - Produces keystream bit at each step
  - Easy to implement in hardware

  {% img /images/studynotes/a51.png %}
2. RC4 Cipher

  - Produces keystream byte at each step
  - One of the most widely used software stream ciphers
    - in older implementations of SSL /TLS; WEP(!)
    - removed from major browsers in 2015

## Block Ciphers

1. Feistel Cipher
  - key will change every round
  - function F must be reversible
  - multiple "rounds"

{% img /images/studynotes/feistel.png %}

## Block Cipher Modes

1. Electronic Code Book (ECB) Mode
  {% img /images/studynotes/ecb.png %}
  - å°‡plain textåˆ‡æˆ blocks
  - åˆ†åˆ¥å°æ¯å€‹blockåšBlock Ciphers
  - ç¼ºé»:åŒæ¨£çš„blockæœƒè¢«åŠ å¯†æˆåŒæ¨£çš„cipher
  - diffusionè¼ƒå·®
2. Cipher Block Chaining (CBC) Mode
  {% img /images/studynotes/cbc.png %}
  - è·ŸECBé¡ä¼¼
  - åœ¨åšå®ŒBlock Ciphersï¼Œæœƒåœ¨è·Ÿå‰ä¸€å€‹blockçš„çµæœåšxorï¼Œæˆç‚ºæœ€å¾ŒåŠ å¯†çš„çµæœ
  - æ”¹å–„diffusion
  - æœ€å¾Œä¸€å€‹blockå¯ä»¥ç•¶[MAC](#data-integrity-mac-blocksmessage-authentication-code) blocks(åŒ…å«æ•´å€‹plain textçš„è³‡è¨Š)
3. Comparison

  ECB   V.S  CBC

  {% img /images/studynotes/ecbgirl.png 280 %}{% img /images/studynotes/cbcgirl.png 280 %}

## AES Cipher
- most popular nowadays

{% img /images/studynotes/aes.png %}

## Symmetric Key Ciphers and Key Reuse

- Depth Attacks : Giving attackers deeper information about your plaintext or key
  - ä¾‹å¦‚ä¹‹å‰çš„one-time pad ï¼Œç•¶keyé‡è¤‡ä½¿ç”¨æ™‚ï¼Œæ”»æ“Šè€…å¯ä»¥å¾—çŸ¥P1 âŠ• P2

  {% img /images/studynotes/depthattack.png %}

- Replay Attacks:
  - ç•¶æ”»æ“Šè€…ç›£è½åˆ°ä¸€å€‹Ciphersï¼Œå‚³é€çµ¦å°æ‡‰çš„äººï¼Œä¸€æ¨£å¯ä»¥å¾—åˆ°æ­£ç¢ºçš„å›è¦†

  {% img /images/studynotes/replyattack.png %}

## Using a Nonce(one-time use random bytes)

  - Countering Depth Attacks :
  ç•¶keyé‡è¤‡ä½¿ç”¨æ™‚ï¼Œé‚„æ˜¯å¯ä»¥å› ç‚ºnonceä¸åŒï¼Œè€ŒåŠ å¯†æˆä¸åŒçš„cipher

  - Countering Replay Attacks :
  ç•¶æ”»æ“Šè€…ç›£è½åˆ°ä¸€å€‹Ciphersï¼Œæƒ³è¦é‡é€æ™‚ï¼Œæœƒå› ç‚ºNonceä¸åŒï¼Œè€Œè¢«æ‹’çµ•ã€‚


---

# Hashing

- No key from the user (built-in key)
- One-way function only (cannot reverse/decrypt)
- Compresses data to fixed length (e.g., 128-bits)
- Collisions exist, but should be extremely rare

## Non-cryptographic Hashing

- Cyclic Redundancy Check (CRC)
  - ğŸ‘ Data Lookup
  - ğŸ‘ Data integrity

  **pro**

  - simple to perform in hardware
  - can catch common, unintentional errors

  **cons**

  - cannot catch intentional manipulation
  - easy to revers
  - crc(xâŠ•yâŠ•z) = crc(x) âŠ• crc(y) âŠ• crc(z)
    well-known design flaws of the Wired Equivalent Privacy (WEP) protocol

## Cryptographic Hashing
  - Sha1 sha2
  - md5
  - ...

## Data Integrity: MAC blocks(Message Authentication Code)
- protects both a message's data integrity as well as its authenticity, by allowing verifiers to detect any changes to the message content.
- åœ¨è§£å¯†å‰å…ˆé©—è­‰è³‡æ–™ä¾†æºåŠæ­£ç¢ºæ€§(æœ‰æ²’æœ‰è¢«è®Šæ›´)
- æ²’æœ‰å…ˆé©—è­‰å°±è§£å¯†çš„è©±ï¼Œæ”»æ“Šè€…èƒ½å¾æ›´æ”¹å¾Œçš„cipherè·Ÿplaintextä¸­å¾—åˆ°é¡å¤–çš„è¨Šæ¯

### Approaches to Authenticated Encryption

1. MAC-and-Encrypt
- encrypy the plaintextthen calculate MAC on plaintext
2. MAC-then-Encrypt (MtE)
- calculate MAC on plaintext and encrypt plaintext + MAC
- vulnerable to Decryption Oracle Attack
- âˆµ you have to perform decryption before Authenticated
3. Encrypt-then-MAC
- encrypy the plaintext then calculate MAC on cipher

---

# Coding time ~

So many things to care about

- which algorithm to apply(must be not broken yet)
- implements a algorithm wihout making mistake
- generate different keys
- use nonce
- Authenticated Encryption order

{% img /images/fun/Jackie-chan-meme.jpg %}

##***Developers should know about cryptography!***

##***But only cryptographers should write ciphers!***

## NaCl

- NaCl : a new easy-to-use highspeed software library for network communication, encryption, decryption, signatures, etc.

Implemented in C

- libSodium :  portable, cross-compilable, installable, packageable fork of NaCl

Implemented in C

- RbNaCl : Ruby binding to the Networking and Cryptography (NaCl) library

Implemented in Ruby, but you have to install libSodium yourself

- rbnacl-libsodium : packages the libsodium library as a Ruby Gem

Implemented in Ruby, the only thing to do is
``` gem install rbnacl-libsodium ```

[Document of RbNaCl](https://github.com/cryptosphere/rbnacl/wiki)

ç‘èŠ±(*ï¿£â–½ï¿£)/â€§â˜†*"' \*-.,_,.-\*'`"*-.,_â˜†